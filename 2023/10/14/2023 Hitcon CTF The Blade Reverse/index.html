<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Looking">
    <meta name="description" content="Looking up at the sky.ğŸ¬ğŸ¬ğŸ“ğŸ’•">
    <meta name="author" content="Jsjsj">
    
    <title>
        
            2023 Hitcon CTF The Blade Reverse |
        
        Jsjsj Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/log.jpg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"jsjsj.top","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true,"layout":"right"},"style":{"primary_color":"#0066cc","logo":"/images/log.jpg","favicon":"/images/log.jpg","avatar":"/images/log.jpg","first_screen":{"enable":true,"background_img":"/images/bg.svg","description":null,"hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"pjax":{"enable":false},"lazyload":{"enable":true},"comment":{"enable":true,"use":"valine","valine":{"appid":"aIJeYmBe1sYhsmeD0Wx4ImDN-MdYXbMMI","appkey":"Gk8i3b8sccXvUCUCkuapvLap","server_urls":"https://aijeymbe.api.lncldglobal.com","placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.21"},"waline":{"server_url":null,"reaction":false,"version":2},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":true,"reward":{"enable":false,"img_link":null,"text":null}},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"version":"3.8.6"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original article title","author":"Original article author","link":"Original article link"}
  </script>
<meta name="generator" content="Hexo 7.0.0-rc2"><link rel="alternate" href="/atom.xml" title="Jsjsj" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container border-box">

    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/log.jpg">
                </a>
            
            <a class="site-name border-box" href="/">
               Jsjsj Blog
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/changelog"
                            >
                                CHANGELOG
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/changelog">CHANGELOG</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">

                

                    <div class="fade-in-down-animation">
    <div class="post-page-container border-box">

        <div class="article-content-container border-box">

            

            <div class="article-content-bottom border-box">
                
                    <div class="article-title">
                        2023 Hitcon CTF The Blade Reverse
                    </div>
                

                
                    <div class="article-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/log.jpg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author">
                                <span class="name">Jsjsj</span>
                                
                                    <span class="author-label">Lv3</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="article-meta-info-container border-box post">
    <div class="article-meta-info border-box">
        


        
            <span class="meta-info-item article-create-date">
                <i class="icon fa-solid fa-calendar-check"></i>&nbsp;
                <span class="pc">2023-10-14 21:55:12</span>
                <span class="mobile">2023-10-14 21:55</span>
            </span>

            <span class="meta-info-item article-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="pc" data-updated="Mon Oct 16 2023 18:00:16 GMT+0800">2023-10-16 18:00:16</span>
            </span>
        

        

        
            <span class="article-tag meta-info-item border-box">
                <i class="icon fas fa-tags"></i>&nbsp;
                <ul class="article-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Reverse/">Reverse</a></li>
                        
                    
                </ul>
            </span>
        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="article-content keep-markdown-body">
                    

                    <p><strong>å‰è¨€ï¼šå¾ˆæœ‰æ„æ€ä¸€é“Reverseé¢˜ï¼Œåœ¨ä½ç§»åŠ å¯†æœ‰å¾ˆå¤šå·§å¦™æ–¹æ³•ï¼Œè¿™é‡Œè®°å½•ä¸‹åšé¢˜çš„è¿‡ç¨‹</strong></p>
<p>è¿™é“é¢˜å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿å‘œå‘œå‘œï¼Œæœ¬ç¯‡è®°å½•ä¸‹è°ƒè¯•å½“ä¸­çš„ä¸€äº›æŠ€å·§æ–¹æ³•å’Œå‚ç…§3clyå¸ˆå‚…çš„åšå®¢ä¸€äº›åŠ å¯†çš„éªšæ“ä½œ</p>
<p>æ­¤é¢˜æ˜¯ä¸ªrust é€†å‘é¢˜ï¼Œæ˜¯ä¸ªsocketç±»å‹çš„äº¤äº’é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨å­—ç¬¦ä¸²å®šä½çš„æ–¹æ³•å®šä½åˆ°å…³é”®éƒ¨åˆ†ï¼Œè¿™é‡Œæˆ‘å®šä½åˆ°äº†å¦‚ä¸‹ä»£ç ä½ç½®ï¼ˆå‰éƒ¨åˆ†æ‰¾å…¥å£æ‰¾åˆ°å¯¹åº”å­—ç¬¦ä¸²ç›´æ¥äº¤å‰å¼•ç”¨å³å¯ï¼‰ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">_rust_dealloc();</span><br><span class="line">        <span class="keyword">goto</span> LABEL_178;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">0x67616C66</span>:   <span class="comment">// flag</span></span><br><span class="line">    v18 = <span class="number">9LL</span>;</span><br><span class="line">    v19 = <span class="string">&quot;IncorrectCorrectError: portscan: too many argumentsnetcatError: netcat: too many argumentsError: netcat: invalid portError: netcat: no input file specifiedUnknown command &#x27;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v182 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v51 = seccomp_shell::shell::verify::h898bf5fa26dafbab(</span><br><span class="line">              input,                <span class="comment">// flag</span></span><br><span class="line">              *(_QWORD *)(v175 + <span class="number">24</span>),</span><br><span class="line">              *(_QWORD *)(v175 + <span class="number">40</span>));</span><br><span class="line">      v53 = v52;</span><br><span class="line">      <span class="keyword">if</span> ( v51 )</span><br><span class="line">        seccomp_shell::util::print_failed::h41a9d0b5672e2e2f(</span><br><span class="line">          <span class="string">&quot;IncorrectCorrectError: portscan: too many argumentsnetcatError: netcat: too many argumentsError: netcat: invalid portError: netcat: no input file specifiedUnknown command &#x27;&quot;</span>,</span><br><span class="line">          <span class="number">9LL</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>seccomp_shell::shell::verify::h898bf5fa26dafbab å®ƒçš„ä¼ å‚å°±æ˜¯æˆ‘ä»¬è¦è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼ˆflag) è¿™ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬è¦é€†çš„ä¸»è¦å‡½æ•°</p>
<p>æˆ‘ä»¬è¿›åˆ°é‡Œé¢å‘ç°ä»£ç å¾ˆå¤šï¼Œè¿™é‡Œæˆ‘åˆ—å‡ºå…³é”®éƒ¨åˆ†ä»£ç </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memcpy</span>(dest, &amp;unk_62920, <span class="number">0x200</span>uLL);</span><br><span class="line">v52 = <span class="number">64LL</span>;</span><br><span class="line">v53 = (__int64 *)dest + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  v54 = *(v53 - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v54 &gt; <span class="number">0x3F</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_53;</span><br><span class="line">  v55 = flag[v52 - <span class="number">1</span>];</span><br><span class="line">  flag[v52 - <span class="number">1</span>] = flag[v54];</span><br><span class="line">  flag[v54] = v55;</span><br><span class="line">  v56 = *v53;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)*v53 &gt; <span class="number">0x3F</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_53;</span><br><span class="line">  v57 = flag[v52 - <span class="number">2</span>];</span><br><span class="line">  flag[v52 - <span class="number">2</span>] = flag[v56];</span><br><span class="line">  flag[v56] = v57;</span><br><span class="line">  v53 += <span class="number">2</span>;</span><br><span class="line">  v52 -= <span class="number">2LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v52 );</span><br></pre></td></tr></table></figure>

<p>æˆ‘æˆªå–äº†æœ€åçš„æ¢ä½åŠ å¯†çš„ä»£ç ï¼Œå‰é¢è¿˜æœ‰å¥½å‡ ä¸ªè¿™æ ·çš„æ¢ä½åŠ å¯†ï¼Œä½†å®ƒæ¢ä½åŠ å¯†çš„è¡¨åœ¨æ•´ä¸ªwhileå¾ªç¯ä¸€æ¬¡ä¸‹æ¥éƒ½æ˜¯å›ºå®šçš„ï¼Œåœ¨æœ€å¤–å±‚çš„whileå¾ªç¯é‡Œæ˜¯256æ¬¡ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">while</span> ( v52 );</span><br><span class="line">  v58 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v59 = (<span class="type">unsigned</span> __int8)flag[v58] + <span class="number">1</span>;</span><br><span class="line">    LOWORD(v51) = <span class="number">1</span>;</span><br><span class="line">    LOWORD(v52) = <span class="number">257</span>;</span><br><span class="line">    v60 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v62 = v52;</span><br><span class="line">      LOWORD(v52) = (<span class="type">unsigned</span> __int16)v52 / (<span class="type">unsigned</span> __int16)v59;</span><br><span class="line">      v61 = v62 % (<span class="type">unsigned</span> __int16)v59;</span><br><span class="line">      v63 = v51;</span><br><span class="line">      v51 = v60 - v51 * v52;</span><br><span class="line">      LODWORD(v52) = v59;</span><br><span class="line">      v59 = (<span class="type">unsigned</span> __int16)(v62 % (<span class="type">unsigned</span> __int16)v59);</span><br><span class="line">      v60 = v63;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v61 );</span><br><span class="line">    v64 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (__int16)v63 &gt; <span class="number">0</span> )</span><br><span class="line">      v64 = v63;</span><br><span class="line">    flag[v58] = ((<span class="type">unsigned</span> __int16)(v64 + ((__int16)v63 &gt;&gt; <span class="number">15</span>) - v63) / <span class="number">0x101</span>u</span><br><span class="line">               + v63</span><br><span class="line">               + ((<span class="type">unsigned</span> __int16)v63 &gt;&gt; <span class="number">15</span>)</span><br><span class="line">               + <span class="number">113</span>) ^ <span class="number">0x89</span>;</span><br><span class="line">    v52 = v58 + <span class="number">1</span>;</span><br><span class="line">    v58 = v52;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v52 != <span class="number">64</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v8 != <span class="number">256</span> );</span><br></pre></td></tr></table></figure>

<p>åœ¨ç»å†å®Œæ¢ä½åŠ å¯†ååˆè¿›è¡Œäº†ä¸€æ¬¡é™¤å–ä½™çš„æ“ä½œ64æ¬¡ï¼Œè¿™é‡ŒçŒœæµ‹ä¸€æ¬¡åªèƒ½å¤„ç†64ä¸ªå­—èŠ‚ï¼ˆå…¶å®å°±æ˜¯64å­—èŠ‚ï¼‰é€šè¿‡è¿™æ®µåŠ å¯†å°†æ•´ä¸ªè¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œäº†ä¸€ä¸ªé™¤+å–ä½™ç­‰æ“ä½œ</p>
<p>ç»è¿‡é€†å‘åˆ†æä»¥ä¸Šè¿›è¡Œæ¢ä½ä½ç§»åŠ å¯†éƒ½æ˜¯ç”¨çš„å›ºå®šçš„ç´¢å¼•ï¼Œåœ¨ä»¥ä¸Šæ¢ä½åŠ å¯†ä»£ç å’Œç¬¬äºŒæ¬¡åŠ å¯†çš„è¡Œä¸ºä¸ç”¨æˆ·è¾“å…¥å€¼æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œç”¨ 00-ff çš„æ˜ å°„ï¼ˆå¼•ç”¨å¸ˆå‚…çš„ä¸€å¥è¯é€†å‘åŠ å¯†ç®—æ³•æ¯”è¾ƒå¤æ‚ï¼Œå°±æ‰¾å‡º 00-ff çš„æ˜ å°„å°±è¡Œäº† å› ä¸ºæ˜¯æŒ‰ä½åŠ å¯†çš„ä¼ç„¶åå‰é¢çš„å‡ æ¬¡æ‰“ä¹±é¡ºåºç”±äºæ˜¯å›ºå®šçš„è¡¨æ‰€ä»¥å¯ä»¥çœ‹æˆä¸€æ¬¡æ‰“ä¹±é¡ºåº æ‰¾å‡ºç´¢å¼•äº¤æ¢çš„é¡ºåºå³å¯ï¼‰</p>
<p>ç”Ÿæˆ 0~ff çš„ hex åºåˆ—ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">256</span>, <span class="number">64</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytearray</span>(<span class="built_in">range</span>(i, i+<span class="number">64</span>)).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå…ˆæ”¾è¿™ï¼Œæˆ‘ä»¬æµ‹è¯•çš„æ•°æ®æ˜¯flag 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ{} å…ˆæŠŠåŠ å¯†å‰çš„æ•°æ®æå–å‡ºæ¥ï¼Œæˆ‘æŠŠæ–­ç‚¹ä¸‹åœ¨äº†è¿™ä¸ªä½ç½®</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="/images/re/1.png"
                     
                ></p>
<p>æå–flagå˜é‡é‡Œçš„æ•°æ®</p>
<p>æ•°æ®æ˜¯HfVl{qPcCYNMoRi6D7Jr}espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m</p>
<p>è¿™æ˜¯æ‰“ä¹±åçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯åœ¨ç»å†ä¸‹é¢åŠ å¯†å‰çš„å­—ç¬¦ä¸²</p>
<p>ä¸‹é¢æˆ‘ä»¬ç”¨ä¸Šé¢hexåºåˆ—è·å–åŠ å¯†åçš„æ•°æ®ï¼Œä¸ºä»€ä¹ˆè¦ç”Ÿæˆ256ï¼Œå› ä¸ºæ•´ä¸ªwileå¾ªç¯æ˜¯256æ‰€ä»¥æˆ‘ä»¬è¦ç”Ÿæˆ256ä¸ªå­—å­—èŠ‚åˆ†åˆ«è¿›è¡Œ64ä¸ªå­—èŠ‚çš„å¤„ç†ï¼Œæ€»å…±è°ƒ4æ¬¡å³å¯</p>
<p>æˆ‘æŠŠæ–­ç‚¹ä¸‹åœ¨äº†å¦‚ä¸‹çš„ä½ç½®ï¼š</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="/images/re/2.png"
                     
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="/images/re/3.png"
                     
                ></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="/images/re/4.png"
                     
                ></p>
<p>æˆ‘ä¸‹äº†å¦‚å›¾ä¸¤ä¸ªæ–­ç‚¹ï¼Œä¸€ä¸ªæ˜¯åŠ å¯†å‰ï¼ˆæ‰“ä¹±åï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯æ•´ä¸ªæ‰§è¡Œå®Œä¸€æ¬¡åçš„åŠ å¯†</p>
<p>æˆ‘ä»¬åŠ¨è°ƒçš„æ—¶å€™ç”¨idapythonè„šæœ¬å»æŠŠflagå˜é‡å€¼ç»™æ”¹ä¸‹ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰é€‰ä¸­çš„åœ°å€</span></span><br><span class="line">current_address = idc.get_screen_ea()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å †æ ˆä¸Šçš„æŒ‡é’ˆå˜é‡åœ°å€</span></span><br><span class="line">stack_pointer = <span class="number">0x556646C923E0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦å†™å…¥çš„éå¸¸é•¿çš„æ•°æ®æŒ‰å°ç«¯åºå­˜å‚¨</span></span><br><span class="line">data = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€å­—èŠ‚å°†æ•°æ®æŒ‰å°ç«¯åºå†™å…¥æŒ‡å®šåœ°å€</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">4</span>):</span><br><span class="line">    value = struct.unpack(<span class="string">&quot;&lt;I&quot;</span>, data[i:i+<span class="number">4</span>])[<span class="number">0</span>]  <span class="comment"># å°ç«¯åº</span></span><br><span class="line">    idaapi.patch_dword(stack_pointer + i, value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°ç»“æœ</span></span><br><span class="line">idaapi.msg(<span class="string">&quot;æ•°æ®å·²æŒ‰å°ç«¯åºå†™å…¥å †æ ˆåœ°å€: 0x&#123;:X&#125;\n&quot;</span>.<span class="built_in">format</span>(stack_pointer))</span><br></pre></td></tr></table></figure>

<p>f9è¿è¡Œåˆ°ä¸‹é¢å“ªä¸ªæ–­ç‚¹æå–çš„åŠ å¯†æ•°æ®æ˜¯</p>
<p>[0xFB, 0x7B, 0x4E, 0xBB, 0x51, 0x15, 0x8D, 0xDB, 0xB0, 0xAC, 0xA5, 0x8E, 0xAA, 0xB2, 0x60, 0xEB, 0x63, 0x5C, 0xDE, 0x42, 0x2B, 0xC6, 0xA6, 0x35, 0x30, 0x43, 0xD6, 0x5F, 0xBD, 0x24, 0xB1, 0xE3, 0x8C, 0xA7, 0xD5, 0x2A, 0x7C, 0x6D, 0x8B, 0x17, 0x9D, 0x83, 0xFE, 0x69, 0x10, 0x59, 0xA9, 0x9E, 0x0F, 0x1C, 0x66, 0x97, 0x5B, 0x61, 0xED, 0xAD, 0xE0, 0xDA, 0x27, 0x06, 0x25, 0xDC, 0x5E, 0xE7, 0x40, 0x41]</p>
<p>æˆ‘ä»¬å‘ç°ç¬¬ä¸€æ¬¡æå–åˆ°0x40å‰ï¼Œå› ä¸ºä¸€æ¬¡åŠ å¯†åªèƒ½å¤„ç†64ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè¿˜è¦å†è¿›è¡Œ3æ¬¡å¤„ç†å‰©ä½™çš„åºåˆ—ï¼Œæˆ‘ä»¬å†åœ¨åŠ¨è°ƒçš„æ—¶å€™æŠŠflagè¿™ä¸ªå˜é‡å€¼æ”¹ä¸º0x40å¼€å§‹</p>
<p>ç¬¬äºŒæ¬¡æ•°æ®æ˜¯4132D2D98FEEAF03933A00A2E1B3EC819FCA58B779FD3BA0020CCBA880C0164D2F75710A0439FFC19CABEFA4D8E214C26C641E6B7E992E090B86746AC42D4FF980</p>
<p>å‰©ä¸‹å†ä»80å¼€å§‹åŠ¨è°ƒï¼Œç›´åˆ°00-255ä¸ªæ•°æ®åŠ å¯†å®Œåå°±æ˜¯æˆ‘ä»¬åŠ¨è°ƒåçš„åŠ å¯†å¯†æ–‡</p>
<p>æ‰¾åˆ°åï¼Œå…ˆè¿˜åŸä¸‹åŠ å¯†åçš„æ•°æ®ï¼Œè¿™é‡Œå‚è€ƒäº†3clyå¸ˆå‚…çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data: <span class="built_in">list</span>, table: <span class="built_in">dict</span></span>):</span><br><span class="line">    tmp=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        tmp.append(table[i])</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_order</span>(<span class="params">data:<span class="built_in">list</span>, table: <span class="built_in">list</span></span>):</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        tmp.append(data[table[i]])</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="comment">#get crypto table</span></span><br><span class="line">s0_255 = [<span class="number">0xFB</span>, <span class="number">0x7B</span>, <span class="number">0x4E</span>, <span class="number">0xBB</span>, <span class="number">0x51</span>, <span class="number">0x15</span>, <span class="number">0x8D</span>, <span class="number">0xDB</span>, <span class="number">0xB0</span>, <span class="number">0xAC</span>, <span class="number">0xA5</span>, <span class="number">0x8E</span>, <span class="number">0xAA</span>, <span class="number">0xB2</span>, <span class="number">0x60</span>, <span class="number">0xEB</span>, <span class="number">0x63</span>, <span class="number">0x5C</span>, <span class="number">0xDE</span>, <span class="number">0x42</span>, <span class="number">0x2B</span>, <span class="number">0xC6</span>, <span class="number">0xA6</span>, <span class="number">0x35</span>, <span class="number">0x30</span>, <span class="number">0x43</span>, <span class="number">0xD6</span>, <span class="number">0x5F</span>, <span class="number">0xBD</span>, <span class="number">0x24</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>, <span class="number">0x8C</span>, <span class="number">0xA7</span>, <span class="number">0xD5</span>, <span class="number">0x2A</span>, <span class="number">0x7C</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0x17</span>, <span class="number">0x9D</span>, <span class="number">0x83</span>, <span class="number">0xFE</span>, <span class="number">0x69</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0xA9</span>, <span class="number">0x9E</span>, <span class="number">0x0F</span>, <span class="number">0x1C</span>, <span class="number">0x66</span>, <span class="number">0x97</span>, <span class="number">0x5B</span>, <span class="number">0x61</span>, <span class="number">0xED</span>, <span class="number">0xAD</span>, <span class="number">0xE0</span>, <span class="number">0xDA</span>, <span class="number">0x27</span>, <span class="number">0x06</span>, <span class="number">0x25</span>, <span class="number">0xDC</span>, <span class="number">0x5E</span>, <span class="number">0xE7</span>,</span><br><span class="line">        <span class="number">0x41</span>, <span class="number">0x32</span>, <span class="number">0xD2</span>, <span class="number">0xD9</span>, <span class="number">0x8F</span>, <span class="number">0xEE</span>, <span class="number">0xAF</span>, <span class="number">0x03</span>, <span class="number">0x93</span>, <span class="number">0x3A</span>, <span class="number">0x00</span>, <span class="number">0xA2</span>, <span class="number">0xE1</span>, <span class="number">0xB3</span>, <span class="number">0xEC</span>, <span class="number">0x81</span>, <span class="number">0x9F</span>, <span class="number">0xCA</span>, <span class="number">0x58</span>, <span class="number">0xB7</span>, <span class="number">0x79</span>, <span class="number">0xFD</span>, <span class="number">0x3B</span>, <span class="number">0xA0</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0xCB</span>, <span class="number">0xA8</span>, <span class="number">0x80</span>, <span class="number">0xC0</span>, <span class="number">0x16</span>, <span class="number">0x4D</span>, <span class="number">0x2F</span>, <span class="number">0x75</span>, <span class="number">0x71</span>, <span class="number">0x0A</span>, <span class="number">0x04</span>, <span class="number">0x39</span>, <span class="number">0xFF</span>, <span class="number">0xC1</span>, <span class="number">0x9C</span>, <span class="number">0xAB</span>, <span class="number">0xEF</span>, <span class="number">0xA4</span>, <span class="number">0xD8</span>, <span class="number">0xE2</span>, <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x6C</span>, <span class="number">0x64</span>, <span class="number">0x1E</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x99</span>, <span class="number">0x2E</span>, <span class="number">0x09</span>, <span class="number">0x0B</span>, <span class="number">0x86</span>, <span class="number">0x74</span>, <span class="number">0x6A</span>, <span class="number">0xC4</span>, <span class="number">0x2D</span>, <span class="number">0x4F</span>, <span class="number">0xF9</span>,</span><br><span class="line">        <span class="number">0xFA</span>, <span class="number">0x94</span>, <span class="number">0xB6</span>, <span class="number">0x1F</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0x5D</span>, <span class="number">0xE8</span>, <span class="number">0xEA</span>, <span class="number">0xB5</span>, <span class="number">0x5A</span>, <span class="number">0x65</span>, <span class="number">0x88</span>, <span class="number">0xC5</span>, <span class="number">0x7F</span>, <span class="number">0x77</span>, <span class="number">0x11</span>, <span class="number">0xCF</span>, <span class="number">0xF1</span>, <span class="number">0x1B</span>, <span class="number">0x3F</span>, <span class="number">0xF4</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x12</span>, <span class="number">0xE4</span>, <span class="number">0xBA</span>, <span class="number">0xDF</span>, <span class="number">0xE9</span>, <span class="number">0x62</span>, <span class="number">0x6E</span>, <span class="number">0xB4</span>, <span class="number">0x96</span>, <span class="number">0xCD</span>, <span class="number">0x13</span>, <span class="number">0x53</span>, <span class="number">0x4B</span>, <span class="number">0x28</span>, <span class="number">0xD7</span>, <span class="number">0xD1</span>, <span class="number">0x33</span>, <span class="number">0xB8</span>, <span class="number">0xE6</span>, <span class="number">0x7A</span>, <span class="number">0x2C</span>, <span class="number">0x9B</span>, <span class="number">0x29</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0xF7</span>, <span class="number">0x20</span>, <span class="number">0xF2</span>, <span class="number">0x31</span>, <span class="number">0xD3</span>, <span class="number">0xB9</span>, <span class="number">0x40</span>, <span class="number">0xD0</span>, <span class="number">0x34</span>, <span class="number">0xF5</span>, <span class="number">0x54</span>, <span class="number">0x1A</span>, <span class="number">0x01</span>, <span class="number">0xA1</span>, <span class="number">0x92</span>,</span><br><span class="line">        <span class="number">0xFC</span>, <span class="number">0x85</span>, <span class="number">0x07</span>, <span class="number">0xBE</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x19</span>, <span class="number">0xF3</span>, <span class="number">0x36</span>, <span class="number">0xF6</span>, <span class="number">0x72</span>, <span class="number">0x98</span>, <span class="number">0x4C</span>, <span class="number">0x7D</span>, <span class="number">0xC7</span>, <span class="number">0xD4</span>, <span class="number">0x45</span>, <span class="number">0x4A</span>, <span class="number">0x9A</span>, <span class="number">0xC3</span>, <span class="number">0x8A</span>, <span class="number">0xE5</span>, <span class="number">0x50</span>, <span class="number">0x46</span>, <span class="number">0xCC</span>, <span class="number">0x68</span>, <span class="number">0x76</span>, <span class="number">0x67</span>, <span class="number">0xC9</span>, <span class="number">0x0E</span>, <span class="number">0x3C</span>, <span class="number">0x57</span>, <span class="number">0xF0</span>, <span class="number">0x22</span>, <span class="number">0xBF</span>, <span class="number">0x26</span>, <span class="number">0x84</span>, <span class="number">0x0D</span>, <span class="number">0x90</span>, <span class="number">0xA3</span>, <span class="number">0xAE</span>, <span class="number">0x3D</span>, <span class="number">0x1D</span>, <span class="number">0xC8</span>, <span class="number">0x91</span>, <span class="number">0x05</span>, <span class="number">0x87</span>, <span class="number">0x70</span>, <span class="number">0x08</span>, <span class="number">0x73</span>, <span class="number">0x21</span>, <span class="number">0x49</span>, <span class="number">0x55</span>, <span class="number">0x3E</span>, <span class="number">0x37</span>, <span class="number">0x23</span>, <span class="number">0x18</span>, <span class="number">0x56</span>, <span class="number">0xCE</span>, <span class="number">0x82</span>, <span class="number">0x38</span>, <span class="number">0x95</span>, <span class="number">0x78</span>, <span class="number">0xF8</span>]</span><br><span class="line"></span><br><span class="line">crypto_table = <span class="built_in">dict</span>(<span class="built_in">zip</span>(s0_255,<span class="built_in">range</span>(<span class="number">0x100</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#get order table</span></span><br><span class="line">source = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;&#x27;</span></span><br><span class="line">replaced = <span class="string">&#x27;HfVl&#123;qPcCYNMoRi6D7Jr&#125;espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m&#x27;</span></span><br><span class="line">revsere_table = [] <span class="comment">#index æ˜¯ source åœ¨ replace ä¸­çš„ä¸‹æ ‡</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> source:</span><br><span class="line">    revsere_table.append(replaced.find(i))</span><br><span class="line"></span><br><span class="line">tmp = [<span class="number">0x52</span>, <span class="number">0xCB</span>, <span class="number">0x15</span>, <span class="number">0x10</span>, <span class="number">0x7E</span>, <span class="number">0xD3</span>, <span class="number">0x78</span>, <span class="number">0x26</span>, <span class="number">0xC2</span>, <span class="number">0x14</span>, <span class="number">0x09</span>, <span class="number">0x50</span>, <span class="number">0x55</span>, <span class="number">0xFA</span>, <span class="number">0xEE</span>, <span class="number">0xC3</span>, <span class="number">0x0A</span>, <span class="number">0x97</span>, <span class="number">0xB9</span>, <span class="number">0x38</span>, <span class="number">0x12</span>, <span class="number">0x3D</span>, <span class="number">0x0E</span>, <span class="number">0xE9</span>, <span class="number">0xBE</span>, <span class="number">0xF6</span>, <span class="number">0x2B</span>, <span class="number">0x66</span>, <span class="number">0x67</span>, <span class="number">0xA8</span>, <span class="number">0x87</span>, <span class="number">0xAE</span>, <span class="number">0x1D</span>, <span class="number">0x53</span>, <span class="number">0x62</span>, <span class="number">0xEC</span>, <span class="number">0xFC</span>, <span class="number">0x5C</span>, <span class="number">0x88</span>, <span class="number">0x68</span>, <span class="number">0x23</span>, <span class="number">0x5B</span>, <span class="number">0x36</span>, <span class="number">0x13</span>, <span class="number">0xFB</span>, <span class="number">0xD7</span>, <span class="number">0xCA</span>, <span class="number">0x7A</span>, <span class="number">0xBD</span>, <span class="number">0xD9</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0xE4</span>, <span class="number">0x2A</span>, <span class="number">0x6C</span>, <span class="number">0x9D</span>, <span class="number">0x86</span>, <span class="number">0xE0</span>, <span class="number">0xA4</span>, <span class="number">0x01</span>, <span class="number">0xBA</span>, <span class="number">0x3B</span>, <span class="number">0x20</span>, <span class="number">0x92</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    tmp = decrypt(tmp, crypto_table)</span><br><span class="line">    tmp = reverse_order(tmp, revsere_table)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> tmp))</span><br><span class="line"><span class="comment"># 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä»¥ä¸Šè„šæœ¬æˆ‘ä»¬å‘ç°å¯ä»¥è¿˜åŸåŸæ¥çš„æ˜æ–‡</p>
<p>tmpæ˜¯æˆ‘ä»¬0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ{}æ•´ä¸ªæµç¨‹åŠ å¯†åçš„æ•°æ®åŠ¨è°ƒå°±å¯ä»¥å¾—åˆ°ï¼Œè¿™é‡Œæ˜¯å æ—¶çš„å€¼ï¼Œå› ä¸ºåé¢è¿˜æœ‰åŠ å¯†çš„æ“ä½œ</p>
<p>ç„¶ååˆ©ç”¨å­—æ¯å¯¹åº”è¡¨è¿˜åŸï¼Œ(è¿™ä¸ªæ“ä½œç®—æ˜¯å­¦åˆ°äº†å‘œå‘œå‘œtql3clyå¸ˆå‚…)</p>
<p>ä¸‹ä¸€æ­¥æˆ‘ä»¬æ¥ç€å¾€ä¸‹è°ƒ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( v8 != <span class="number">256</span> );</span><br><span class="line">v65 = (<span class="type">void</span> *)alloc::raw_vec::RawVec$LT$T$C$A$GT$::allocate_in::h9362616e9151d1f3(<span class="number">255LL</span>, <span class="number">0LL</span>);</span><br><span class="line">v67 = v66;</span><br><span class="line"><span class="built_in">memcpy</span>(v65, sub_5625F9C2BB2B, <span class="number">0xFF</span>uLL);</span><br><span class="line">v81 = v65;</span><br><span class="line">v82 = v67;</span><br><span class="line">v83 = <span class="number">255LL</span>;</span><br><span class="line">alloc::vec::Vec$LT$T$C$A$GT$::resize::h7362553f00beaec8(&amp;v81, <span class="number">255LL</span>, <span class="number">0LL</span>);</span><br><span class="line"><span class="keyword">if</span> ( *(_DWORD *)(v85 + <span class="number">16</span>) == <span class="number">-1</span> )</span><br><span class="line">  core::panicking::panic::h65157a6ac7f1357a();</span><br><span class="line">v84 = v85 + <span class="number">16</span>;</span><br><span class="line">dest[<span class="number">0</span>] = xmmword_5625F9C29010;</span><br><span class="line">dest[<span class="number">1</span>] = xmmword_5625F9C29020;</span><br><span class="line">dest[<span class="number">2</span>] = xmmword_5625F9C29030;</span><br><span class="line">dest[<span class="number">3</span>] = xmmword_5625F9C29040;</span><br><span class="line">v68 = v83;</span><br><span class="line"><span class="keyword">if</span> ( v83 &lt; <span class="number">0xCD</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_74;</span><br></pre></td></tr></table></figure>

<p>sub_5625F9C2BB2B  è¿™ä¸ªé‡Œé¢ä¸€å¼€å§‹æ˜¯opcodeï¼Œæˆ‘ä»¬å¤åˆ¶å‡ºæ¥çœ‹ä¸‹å®ƒçš„æ±‡ç¼–</p>
<p>è¿™é‡Œç”¨äº†pythonçš„ä¸€ä¸ªè„šæœ¬ï¼Œå°†æŒ‡ä»¤è¿˜åŸæ±‡ç¼–æŒ‡ä»¤ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> capstone</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">disassemble_hex_instructions</span>(<span class="params">hex_instructions</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Create a Capstone engine</span></span><br><span class="line">        md = capstone.Cs(capstone.CS_ARCH_X86, capstone.CS_MODE_64)</span><br><span class="line">        instructions = []</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Convert the hexadecimal instructions to bytes</span></span><br><span class="line">        byte_data = <span class="built_in">bytes</span>(hex_instructions)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Disassemble each instruction</span></span><br><span class="line">        <span class="keyword">for</span> insn <span class="keyword">in</span> md.disasm(byte_data, <span class="number">0x1000</span>):</span><br><span class="line">            instructions.append(<span class="string">&quot;0x%x:\t%s\t%s&quot;</span> % (insn.address, insn.mnemonic, insn.op_str))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> capstone.CsError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Capstone Error: %s&quot;</span> % e)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># Input hexadecimal instructions</span></span><br><span class="line">    hex_instructions = [<span class="number">0x54</span>, <span class="number">0x5D</span>, <span class="number">0x31</span>, <span class="number">0xF6</span>, <span class="number">0x48</span>, <span class="number">0xB9</span>, <span class="number">0xA1</span>, <span class="number">0x57</span>, <span class="number">0x06</span>, <span class="number">0xB8</span>, <span class="number">0x62</span>, <span class="number">0x3A</span>, <span class="number">0x9F</span>, <span class="number">0x37</span>, <span class="number">0x48</span>, <span class="number">0xBA</span>, <span class="number">0x8E</span>, <span class="number">0x35</span>, <span class="number">0x6F</span>, <span class="number">0xD6</span>, <span class="number">0x4D</span>, <span class="number">0x49</span>, <span class="number">0xF7</span>, <span class="number">0x37</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xD1</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x5F</span>, <span class="number">0x6A</span>, <span class="number">0x02</span>, <span class="number">0x58</span>, <span class="number">0x99</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x48</span>, <span class="number">0x97</span>, <span class="number">0x31</span>, <span class="number">0xC0</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x5E</span>, <span class="number">0x6A</span>, <span class="number">0x04</span>, <span class="number">0x5A</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x41</span>, <span class="number">0x5C</span>, <span class="number">0x6A</span>, <span class="number">0x03</span>, <span class="number">0x58</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x31</span>, <span class="number">0xF6</span>, <span class="number">0x48</span>, <span class="number">0xB9</span>, <span class="number">0x3B</span>, <span class="number">0x3B</span>, <span class="number">0x6F</span>, <span class="number">0xC3</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0xC0</span>, <span class="number">0xAA</span>, <span class="number">0x48</span>, <span class="number">0xBA</span>, <span class="number">0x48</span>, <span class="number">0x4C</span>, <span class="number">0x0B</span>, <span class="number">0xC3</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0xC0</span>, <span class="number">0xAA</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xD1</span>, <span class="number">0x51</span>, <span class="number">0x48</span>, <span class="number">0xB9</span>, <span class="number">0x8C</span>, <span class="number">0x57</span>, <span class="number">0x82</span>, <span class="number">0x75</span>, <span class="number">0xD6</span>, <span class="number">0xF8</span>, <span class="number">0xA9</span>, <span class="number">0x7D</span>, <span class="number">0x48</span>, <span class="number">0xBA</span>, <span class="number">0xA3</span>, <span class="number">0x32</span>, <span class="number">0xF6</span>, <span class="number">0x16</span>, <span class="number">0xF9</span>, <span class="number">0x88</span>, <span class="number">0xC8</span>, <span class="number">0x0E</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xD1</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x5F</span>, <span class="number">0x6A</span>, <span class="number">0x02</span>, <span class="number">0x58</span>, <span class="number">0x99</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x48</span>, <span class="number">0x97</span>, <span class="number">0x31</span>, <span class="number">0xC0</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x5E</span>, <span class="number">0x6A</span>, <span class="number">0x04</span>, <span class="number">0x5A</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x41</span>, <span class="number">0x5D</span>, <span class="number">0x6A</span>, <span class="number">0x03</span>, <span class="number">0x58</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x31</span>, <span class="number">0xF6</span>, <span class="number">0x6A</span>, <span class="number">0x6F</span>, <span class="number">0x48</span>, <span class="number">0xB9</span>, <span class="number">0x59</span>, <span class="number">0xE5</span>, <span class="number">0x06</span>, <span class="number">0x0C</span>, <span class="number">0x2D</span>, <span class="number">0xF6</span>, <span class="number">0xD9</span>, <span class="number">0x77</span>, <span class="number">0x48</span>, <span class="number">0xBA</span>, <span class="number">0x76</span>, <span class="number">0x81</span>, <span class="number">0x63</span>, <span class="number">0x7A</span>, <span class="number">0x02</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0x05</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xD1</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x5F</span>, <span class="number">0x6A</span>, <span class="number">0x02</span>, <span class="number">0x58</span>, <span class="number">0x99</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x48</span>, <span class="number">0x97</span>, <span class="number">0x31</span>, <span class="number">0xC0</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x5E</span>, <span class="number">0x6A</span>, <span class="number">0x04</span>, <span class="number">0x5A</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x58</span>, <span class="number">0x48</span>, <span class="number">0xF7</span>, <span class="number">0xD0</span>, <span class="number">0x48</span>, <span class="number">0xC1</span>, <span class="number">0xE8</span>, <span class="number">0x1D</span>, <span class="number">0x48</span>, <span class="number">0x99</span>, <span class="number">0x6A</span>, <span class="number">0x29</span>, <span class="number">0x59</span>, <span class="number">0x48</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0x49</span>, <span class="number">0x96</span>, <span class="number">0x6A</span>, <span class="number">0x03</span>, <span class="number">0x58</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xEF</span>, <span class="number">0xBE</span>, <span class="number">0xAD</span>, <span class="number">0xDE</span>, <span class="number">0x44</span>, <span class="number">0x01</span>, <span class="number">0xE0</span>, <span class="number">0x44</span>, <span class="number">0x31</span>, <span class="number">0xE8</span>, <span class="number">0xC1</span>, <span class="number">0xC8</span>, <span class="number">0x0B</span>, <span class="number">0xF7</span>, <span class="number">0xD0</span>, <span class="number">0x44</span>, <span class="number">0x31</span>, <span class="number">0xF0</span>, <span class="number">0x3D</span>, <span class="number">0xEF</span>, <span class="number">0xBE</span>, <span class="number">0xAD</span>, <span class="number">0xDE</span>, <span class="number">0x75</span>, <span class="number">0x05</span>, <span class="number">0x6A</span>, <span class="number">0x01</span>, <span class="number">0x58</span>, <span class="number">0xEB</span>, <span class="number">0x03</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xC0</span>, <span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x5F</span>, <span class="number">0x54</span>, <span class="number">0x5E</span>, <span class="number">0x6A</span>, <span class="number">0x08</span>, <span class="number">0x5A</span>, <span class="number">0x6A</span>, <span class="number">0x01</span>, <span class="number">0x58</span>, <span class="number">0x0F</span>, <span class="number">0x05</span>, <span class="number">0x55</span>, <span class="number">0x5C</span>, <span class="number">0x41</span>]</span><br><span class="line">    disassembled_instructions = disassemble_hex_instructions(<span class="built_in">bytearray</span>(hex_instructions))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> disassembled_instructions:</span><br><span class="line">        <span class="keyword">for</span> instruction <span class="keyword">in</span> disassembled_instructions:</span><br><span class="line">            <span class="built_in">print</span>(instruction)</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"><span class="keyword">from</span> keystone <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">assemble_call_instruction</span>(<span class="params">call_address</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ks = Ks(KS_ARCH_X86, KS_MODE_64)</span><br><span class="line">        call_instruction = <span class="string">f&quot;call <span class="subst">&#123;call_address:#X&#125;</span>&quot;</span></span><br><span class="line">        encoding, _ = ks.asm(call_instruction)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(encoding)</span><br><span class="line">    <span class="keyword">except</span> KsError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Keystone Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># Address to call</span></span><br><span class="line">    call_address = <span class="number">0x0000559395BE3430</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Assemble the CALL instruction</span></span><br><span class="line">    assembled_instruction = assemble_call_instruction(call_address)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> assembled_instruction:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Assembled CALL instruction: <span class="subst">&#123;assembled_instruction.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆäº†å¦‚ä¸‹æ±‡ç¼–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">tconexp/hb.py</span><br><span class="line">0x1000: push    rsp</span><br><span class="line">0x1001: pop     rbp</span><br><span class="line">0x1002: xor     esi, esi</span><br><span class="line">0x1004: movabs  rcx, 0x379f3a62b80657a1</span><br><span class="line">0x100e: movabs  rdx, 0x37f7494dd66f358e</span><br><span class="line">0x1018: xor     rcx, rdx</span><br><span class="line">0x101b: push    rcx</span><br><span class="line">0x101c: push    rsp</span><br><span class="line">0x101d: pop     rdi</span><br><span class="line">0x101e: push    2</span><br><span class="line">0x1020: pop     rax</span><br><span class="line">0x1021: cdq</span><br><span class="line">0x1022: syscall</span><br><span class="line">0x1024: xchg    rdi, rax</span><br><span class="line">0x1026: xor     eax, eax</span><br><span class="line">0x1028: push    rax</span><br><span class="line">0x1029: push    rsp</span><br><span class="line">0x102a: pop     rsi</span><br><span class="line">0x102b: push    4</span><br><span class="line">0x102d: pop     rdx</span><br><span class="line">0x102e: syscall</span><br><span class="line">0x1030: pop     r12</span><br><span class="line">0x1032: push    3</span><br><span class="line">0x1034: pop     rax</span><br><span class="line">0x1035: syscall</span><br><span class="line">0x1037: xor     esi, esi</span><br><span class="line">0x1039: movabs  rcx, 0xaac06463c36f3b3b</span><br><span class="line">0x1043: movabs  rdx, 0xaac06463c30b4c48</span><br><span class="line">0x104d: xor     rcx, rdx</span><br><span class="line">0x1050: push    rcx</span><br><span class="line">0x1051: movabs  rcx, 0x7da9f8d67582578c</span><br><span class="line">0x105b: movabs  rdx, 0xec888f916f632a3</span><br><span class="line">0x1065: xor     rcx, rdx</span><br><span class="line">0x1068: push    rcx</span><br><span class="line">0x1069: push    rsp</span><br><span class="line">0x106a: pop     rdi</span><br><span class="line">0x106b: push    2</span><br><span class="line">0x106d: pop     rax</span><br><span class="line">0x106e: cdq</span><br><span class="line">0x106f: syscall</span><br><span class="line">0x1071: xchg    rdi, rax</span><br><span class="line">0x1073: xor     eax, eax</span><br><span class="line">0x1075: push    rax</span><br><span class="line">0x1076: push    rsp</span><br><span class="line">0x1077: pop     rsi</span><br><span class="line">0x1078: push    4</span><br><span class="line">0x107a: pop     rdx</span><br><span class="line">0x107b: syscall</span><br><span class="line">0x107d: pop     r13</span><br><span class="line">0x107f: push    3</span><br><span class="line">0x1081: pop     rax</span><br><span class="line">0x1082: syscall</span><br><span class="line">0x1084: xor     esi, esi</span><br><span class="line">0x1086: push    0x6f</span><br><span class="line">0x1088: movabs  rcx, 0x77d9f62d0c06e559</span><br><span class="line">0x1092: movabs  rdx, 0x5bc8c027a638176</span><br><span class="line">0x109c: xor     rcx, rdx</span><br><span class="line">0x109f: push    rcx</span><br><span class="line">0x10a0: push    rsp</span><br><span class="line">0x10a1: pop     rdi</span><br><span class="line">0x10a2: push    2</span><br><span class="line">0x10a4: pop     rax</span><br><span class="line">0x10a5: cdq</span><br><span class="line">0x10a6: syscall</span><br><span class="line">0x10a8: xchg    rdi, rax</span><br><span class="line">0x10aa: xor     eax, eax</span><br><span class="line">0x10ac: push    rax</span><br><span class="line">0x10ad: push    rsp</span><br><span class="line">0x10ae: pop     rsi</span><br><span class="line">0x10af: push    4</span><br><span class="line">0x10b1: pop     rdx</span><br><span class="line">0x10b2: syscall</span><br><span class="line">0x10b4: pop     rax</span><br><span class="line">0x10b5: not     rax</span><br><span class="line">0x10b8: shr     rax, 0x1d</span><br><span class="line">0x10bc: cqo</span><br><span class="line">0x10be: push    0x29</span><br><span class="line">0x10c0: pop     rcx</span><br><span class="line">0x10c1: div     rcx</span><br><span class="line">0x10c4: xchg    r14, rax</span><br><span class="line">0x10c6: push    3</span><br><span class="line">0x10c8: pop     rax</span><br><span class="line">0x10c9: syscall</span><br><span class="line">0x10cb: mov     eax, 0xdeadbeef</span><br><span class="line">0x10d0: add     eax, r12d</span><br><span class="line">0x10d3: xor     eax, r13d</span><br><span class="line">0x10d6: ror     eax, 0xb</span><br><span class="line">0x10d9: not     eax</span><br><span class="line">0x10db: xor     eax, r14d</span><br><span class="line">0x10de: cmp     eax, 0xdeadbeef</span><br><span class="line">0x10e3: jne     0x10ea</span><br><span class="line">0x10e5: push    1</span><br><span class="line">0x10e7: pop     rax</span><br><span class="line">0x10e8: jmp     0x10ed</span><br><span class="line">0x10ea: xor     rax, rax</span><br><span class="line">0x10ed: push    rax</span><br><span class="line">0x10ee: push    rbx</span><br><span class="line">0x10ef: pop     rdi</span><br><span class="line">0x10f0: push    rsp</span><br><span class="line">0x10f1: pop     rsi</span><br><span class="line">0x10f2: push    8</span><br><span class="line">0x10f4: pop     rdx</span><br><span class="line">0x10f5: push    1</span><br><span class="line">0x10f7: pop     rax</span><br><span class="line">0x10f8: syscall</span><br><span class="line">0x10fa: push    rbp</span><br><span class="line">0x10fb: pop     rsp</span><br></pre></td></tr></table></figure>

<p>ç›®å‰å‘ç°æ²¡ä»€ä¹ˆç”¨å…ˆæ”¾è¿™ï¼Œç»§ç»­å¾€ä¸‹åŠ¨è°ƒï¼Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">v81 = v65;</span><br><span class="line"> v82 = v67;</span><br><span class="line"> v83 = <span class="number">255LL</span>;</span><br><span class="line"> alloc::vec::Vec$LT$T$C$A$GT$::resize::h7362553f00beaec8(&amp;v81, <span class="number">255LL</span>, <span class="number">0LL</span>);</span><br><span class="line"> <span class="keyword">if</span> ( *(_DWORD *)(v85 + <span class="number">16</span>) == <span class="number">-1</span> )</span><br><span class="line">   core::panicking::panic::h65157a6ac7f1357a();</span><br><span class="line"> v84 = v85 + <span class="number">16</span>;</span><br><span class="line"> dest[<span class="number">0</span>] = xmmword_5625F9C29010;</span><br><span class="line"> dest[<span class="number">1</span>] = xmmword_5625F9C29020;</span><br><span class="line"> dest[<span class="number">2</span>] = xmmword_5625F9C29030;</span><br><span class="line"> dest[<span class="number">3</span>] = xmmword_5625F9C29040;</span><br><span class="line"> v68 = v83;</span><br></pre></td></tr></table></figure>

<p>å‘ç°destèµ‹äº†æ–°å€¼ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªä»£ç æ‰§è¡Œå®Œåé¢ çš„ä½ç½®ç”¨ida patchåˆ°ä¸Šé¢å“ªä¸ªshellcodeä½ç½®</p>
<p>ï¼Œå‘ç°è¿™ä¸ªä½ç½®æ”¹å˜äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0x10cb: mov     eax, 0xxxxx  è¿™ä¸ªå˜æˆäº†æˆ‘ä»¬è¾“å…¥çš„æ•°æ®å‰4ä¸ªbyte</span><br><span class="line">0x10d0: add     eax, r12d</span><br><span class="line">0x10d3: xor     eax, r13d</span><br><span class="line">0x10d6: ror     eax, 0xb</span><br><span class="line">0x10d9: not     eax</span><br><span class="line">0x10db: xor     eax, r14d</span><br><span class="line">0x10de: cmp     eax, 0xxxxxx   è¿™é‡Œå˜æˆäº†æˆ‘ä»¬çš„destæ•°æ®ä¹Ÿå°±æ˜¯æ¯”è¾ƒçš„ç›®çš„æ•°æ®</span><br></pre></td></tr></table></figure>

<p>å—¯ï¼Œåˆ†æè¿™å—å…³é”®ä»£ç æˆ‘ä»¬å‘ç°è¿™é‡Œè¿›è¡Œäº†xor ror not xoræ“ä½œï¼Œå…¶ä¸­r12 r13 r14æ˜¯æœªçŸ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æƒ³åŠæ³•è·å–è¿™3ä¸ªå¯„å­˜å™¨çš„å€¼ï¼Œæˆ‘ä¸€å¼€å§‹æƒ³patchæºç¨‹åºåˆ°è¿™ä¸ªä½ç½®ï¼Œå‘ç°åˆ°äº†è¿™ä¸ªä½ç½®å°±æ— æ³•æ‰§è¡Œ äº†ï¼Œæ‰€ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•ï¼Œå°±æ±‡ç¼–å†™å‡ºasmæ–‡ä»¶ï¼Œè¿›è¡Œnasmç¼–è¯‘ï¼Œç„¶åå†åŠ¨è°ƒæŠŠæ–­ç‚¹ä¸‹åœ¨0x10cbå°±å¯ä»¥æŸ¥çœ‹r12 13 14çš„å€¼äº†</p>
<p>ç¼–è¯‘å…·ä½“æ–¹æ³•ï¼š</p>
<p>n.asm:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">section .text</span><br><span class="line">global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rbp</span><br><span class="line">    xor     esi, esi</span><br><span class="line">    mov     rcx, 0x379f3a62b80657a1</span><br><span class="line">    mov     rdx, 0x37f7494dd66f358e</span><br><span class="line">    xor     rcx, rdx</span><br><span class="line">    push    rcx</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rdi</span><br><span class="line">    push    2</span><br><span class="line">    pop     rax</span><br><span class="line">    cdq</span><br><span class="line">    syscall</span><br><span class="line">    xchg    rdi, rax</span><br><span class="line">    xor     rax, rax</span><br><span class="line">    push    rax</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rsi</span><br><span class="line">    push    4</span><br><span class="line">    pop     rdx</span><br><span class="line">    syscall</span><br><span class="line">    pop     r12</span><br><span class="line">    push    3</span><br><span class="line">    pop     rax</span><br><span class="line">    syscall</span><br><span class="line">    xor     esi, esi</span><br><span class="line">    mov     rcx, 0xaac06463c36f3b3b</span><br><span class="line">    mov     rdx, 0xaac06463c30b4c48</span><br><span class="line">    xor     rcx, rdx</span><br><span class="line">    push    rcx</span><br><span class="line">    mov     rcx, 0x7da9f8d67582578c</span><br><span class="line">    mov     rdx, 0xec888f916f632a3</span><br><span class="line">    xor     rcx, rdx</span><br><span class="line">    push    rcx</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rdi</span><br><span class="line">    push    2</span><br><span class="line">    pop     rax</span><br><span class="line">    cdq</span><br><span class="line">    syscall</span><br><span class="line">    xchg    rdi, rax</span><br><span class="line">    xor     rax, rax</span><br><span class="line">    push    rax</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rsi</span><br><span class="line">    push    4</span><br><span class="line">    pop     rdx</span><br><span class="line">    syscall</span><br><span class="line">    pop     r13</span><br><span class="line">    push    3</span><br><span class="line">    pop     rax</span><br><span class="line">    syscall</span><br><span class="line">    xor     esi, esi</span><br><span class="line">    push    0x6f</span><br><span class="line">    mov     rcx, 0x77d9f62d0c06e559</span><br><span class="line">    mov     rdx, 0x5bc8c027a638176</span><br><span class="line">    xor     rcx, rdx</span><br><span class="line">    push    rcx</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rdi</span><br><span class="line">    push    2</span><br><span class="line">    pop     rax</span><br><span class="line">    cdq</span><br><span class="line">    syscall</span><br><span class="line">    xchg    rdi, rax</span><br><span class="line">    xor     rax, rax</span><br><span class="line">    push    rax</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rsi</span><br><span class="line">    push    4</span><br><span class="line">    pop     rdx</span><br><span class="line">    syscall</span><br><span class="line">    pop     rax</span><br><span class="line">    not     rax</span><br><span class="line">    shr     rax, 0x1d</span><br><span class="line">    cqo</span><br><span class="line">    push    0x29</span><br><span class="line">    pop     rcx</span><br><span class="line">    div     rcx</span><br><span class="line">    xchg    r14, rax</span><br><span class="line">    push    3</span><br><span class="line">    pop     rax</span><br><span class="line">    syscall</span><br><span class="line">    mov     eax, 0xdeadbeef</span><br><span class="line">    add     eax, r12d</span><br><span class="line">    xor     eax, r13d</span><br><span class="line">    ror     eax, 0xb</span><br><span class="line">    not     eax</span><br><span class="line">    xor     eax, r14d</span><br><span class="line">    cmp     eax, 0xdeadbeef</span><br><span class="line">    jne     short not_equal</span><br><span class="line">    push    1</span><br><span class="line">    pop     rax</span><br><span class="line">    jmp     short done</span><br><span class="line">not_equal:</span><br><span class="line">    xor     rax, rax</span><br><span class="line">done:</span><br><span class="line">    push    rax</span><br><span class="line">    push    rbx</span><br><span class="line">    pop     rdi</span><br><span class="line">    push    rsp</span><br><span class="line">    pop     rsi</span><br><span class="line">    push    8</span><br><span class="line">    pop     rdx</span><br><span class="line">    push    1</span><br><span class="line">    pop     rax</span><br><span class="line">    syscall</span><br><span class="line">    push    rbp</span><br><span class="line">    pop     rsp</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nasm -f elf64 -o vuln.o n.asm</span><br><span class="line">ld -o my_program vuln.o</span><br></pre></td></tr></table></figure>

<p>å°†ä¸Šé¢çš„æ±‡ç¼–è¿›è¡Œç¼–è¯‘ç”Ÿæˆelfæ–‡ä»¶ï¼Œç„¶åå†ä½¿ç”¨idaåŠ¨è°ƒå¾—åˆ°å¦‚ä¸‹</p>
<p>r12 &#x3D; 0x0000000464C457F    r13 &#x3D; 0x0000000746F6F72    r14 &#x3D; 0x000000031F3831F</p>
<p>åˆ†æå®Œé€»è¾‘æˆ‘ä»¬å°±å¯ä»¥å†™è§£å¯†è„šæœ¬äº†ï¼Œå‚è€ƒ3clyå¸ˆå‚…çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data: <span class="built_in">list</span>, table: <span class="built_in">dict</span></span>):</span><br><span class="line">    tmp=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        tmp.append(table[i])</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_order</span>(<span class="params">data:<span class="built_in">list</span>, table: <span class="built_in">list</span></span>):</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        tmp.append(data[table[i]])</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">def de_cmp(x):</span></span><br><span class="line"><span class="string">    r12 = 0x0000000464C457F</span></span><br><span class="line"><span class="string">    r13 = 0x0000000746F6F72</span></span><br><span class="line"><span class="string">    r14 = 0x000000031F3831F</span></span><br><span class="line"><span class="string">    x ^= r14</span></span><br><span class="line"><span class="string">    x = ~x</span></span><br><span class="line"><span class="string">    x = (x &lt;&lt; 11) | (x &gt;&gt; (32 - 11))</span></span><br><span class="line"><span class="string">    x ^= r13</span></span><br><span class="line"><span class="string">    x -= r12</span></span><br><span class="line"><span class="string">    print(hex(x))</span></span><br><span class="line"><span class="string">    return [x &amp; 0xff, (x &amp; 0xff00) &gt;&gt; 8, (x &amp; 0xff0000) &gt;&gt; 16, (x &amp; 0xff000000) &gt;&gt; 24]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de_cmp</span>(<span class="params">x</span>):</span><br><span class="line">    r12 = <span class="number">0x0000000464C457F</span></span><br><span class="line">    r13 = <span class="number">0x0000000746F6F72</span></span><br><span class="line">    r14 = <span class="number">0x000000031F3831F</span></span><br><span class="line"></span><br><span class="line">    x = np.uint32(x)</span><br><span class="line">    x = np.uint32(x ^ r14)</span><br><span class="line">    x = np.uint32(~x)</span><br><span class="line">    x = np.uint32((x &lt;&lt; <span class="number">11</span>) | (x &gt;&gt; (<span class="number">32</span> - <span class="number">11</span>)))</span><br><span class="line">    x = np.uint32(x ^ r13)</span><br><span class="line">    x = np.uint32(x - r12)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(x))</span><br><span class="line">    x = np.int32(x)</span><br><span class="line">    <span class="keyword">return</span> [x &amp; <span class="number">0xff</span>, (x &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>, (x &amp; <span class="number">0xff0000</span>) &gt;&gt; <span class="number">16</span>, (x &amp; <span class="number">0xff000000</span>) &gt;&gt; <span class="number">24</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># get crypto table</span></span><br><span class="line">s0_255 = [<span class="number">0xFB</span>, <span class="number">0x7B</span>, <span class="number">0x4E</span>, <span class="number">0xBB</span>, <span class="number">0x51</span>, <span class="number">0x15</span>, <span class="number">0x8D</span>, <span class="number">0xDB</span>, <span class="number">0xB0</span>, <span class="number">0xAC</span>, <span class="number">0xA5</span>, <span class="number">0x8E</span>, <span class="number">0xAA</span>, <span class="number">0xB2</span>, <span class="number">0x60</span>, <span class="number">0xEB</span>, <span class="number">0x63</span>, <span class="number">0x5C</span>, <span class="number">0xDE</span>, <span class="number">0x42</span>, <span class="number">0x2B</span>, <span class="number">0xC6</span>, <span class="number">0xA6</span>, <span class="number">0x35</span>, <span class="number">0x30</span>, <span class="number">0x43</span>, <span class="number">0xD6</span>, <span class="number">0x5F</span>, <span class="number">0xBD</span>, <span class="number">0x24</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>, <span class="number">0x8C</span>, <span class="number">0xA7</span>, <span class="number">0xD5</span>, <span class="number">0x2A</span>, <span class="number">0x7C</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0x17</span>, <span class="number">0x9D</span>, <span class="number">0x83</span>, <span class="number">0xFE</span>, <span class="number">0x69</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0xA9</span>, <span class="number">0x9E</span>, <span class="number">0x0F</span>, <span class="number">0x1C</span>, <span class="number">0x66</span>, <span class="number">0x97</span>, <span class="number">0x5B</span>, <span class="number">0x61</span>, <span class="number">0xED</span>, <span class="number">0xAD</span>, <span class="number">0xE0</span>, <span class="number">0xDA</span>, <span class="number">0x27</span>, <span class="number">0x06</span>, <span class="number">0x25</span>, <span class="number">0xDC</span>, <span class="number">0x5E</span>, <span class="number">0xE7</span>,</span><br><span class="line">        <span class="number">0x41</span>, <span class="number">0x32</span>, <span class="number">0xD2</span>, <span class="number">0xD9</span>, <span class="number">0x8F</span>, <span class="number">0xEE</span>, <span class="number">0xAF</span>, <span class="number">0x03</span>, <span class="number">0x93</span>, <span class="number">0x3A</span>, <span class="number">0x00</span>, <span class="number">0xA2</span>, <span class="number">0xE1</span>, <span class="number">0xB3</span>, <span class="number">0xEC</span>, <span class="number">0x81</span>, <span class="number">0x9F</span>, <span class="number">0xCA</span>, <span class="number">0x58</span>, <span class="number">0xB7</span>, <span class="number">0x79</span>, <span class="number">0xFD</span>, <span class="number">0x3B</span>, <span class="number">0xA0</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0xCB</span>, <span class="number">0xA8</span>, <span class="number">0x80</span>, <span class="number">0xC0</span>, <span class="number">0x16</span>, <span class="number">0x4D</span>, <span class="number">0x2F</span>, <span class="number">0x75</span>, <span class="number">0x71</span>, <span class="number">0x0A</span>, <span class="number">0x04</span>, <span class="number">0x39</span>, <span class="number">0xFF</span>, <span class="number">0xC1</span>, <span class="number">0x9C</span>, <span class="number">0xAB</span>, <span class="number">0xEF</span>, <span class="number">0xA4</span>, <span class="number">0xD8</span>, <span class="number">0xE2</span>, <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x6C</span>, <span class="number">0x64</span>, <span class="number">0x1E</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x99</span>, <span class="number">0x2E</span>, <span class="number">0x09</span>, <span class="number">0x0B</span>, <span class="number">0x86</span>, <span class="number">0x74</span>, <span class="number">0x6A</span>, <span class="number">0xC4</span>, <span class="number">0x2D</span>, <span class="number">0x4F</span>, <span class="number">0xF9</span>,</span><br><span class="line">        <span class="number">0xFA</span>, <span class="number">0x94</span>, <span class="number">0xB6</span>, <span class="number">0x1F</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0x5D</span>, <span class="number">0xE8</span>, <span class="number">0xEA</span>, <span class="number">0xB5</span>, <span class="number">0x5A</span>, <span class="number">0x65</span>, <span class="number">0x88</span>, <span class="number">0xC5</span>, <span class="number">0x7F</span>, <span class="number">0x77</span>, <span class="number">0x11</span>, <span class="number">0xCF</span>, <span class="number">0xF1</span>, <span class="number">0x1B</span>, <span class="number">0x3F</span>, <span class="number">0xF4</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x12</span>, <span class="number">0xE4</span>, <span class="number">0xBA</span>, <span class="number">0xDF</span>, <span class="number">0xE9</span>, <span class="number">0x62</span>, <span class="number">0x6E</span>, <span class="number">0xB4</span>, <span class="number">0x96</span>, <span class="number">0xCD</span>, <span class="number">0x13</span>, <span class="number">0x53</span>, <span class="number">0x4B</span>, <span class="number">0x28</span>, <span class="number">0xD7</span>, <span class="number">0xD1</span>, <span class="number">0x33</span>, <span class="number">0xB8</span>, <span class="number">0xE6</span>, <span class="number">0x7A</span>, <span class="number">0x2C</span>, <span class="number">0x9B</span>, <span class="number">0x29</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0xF7</span>, <span class="number">0x20</span>, <span class="number">0xF2</span>, <span class="number">0x31</span>, <span class="number">0xD3</span>, <span class="number">0xB9</span>, <span class="number">0x40</span>, <span class="number">0xD0</span>, <span class="number">0x34</span>, <span class="number">0xF5</span>, <span class="number">0x54</span>, <span class="number">0x1A</span>, <span class="number">0x01</span>, <span class="number">0xA1</span>, <span class="number">0x92</span>,</span><br><span class="line">        <span class="number">0xFC</span>, <span class="number">0x85</span>, <span class="number">0x07</span>, <span class="number">0xBE</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x19</span>, <span class="number">0xF3</span>, <span class="number">0x36</span>, <span class="number">0xF6</span>, <span class="number">0x72</span>, <span class="number">0x98</span>, <span class="number">0x4C</span>, <span class="number">0x7D</span>, <span class="number">0xC7</span>, <span class="number">0xD4</span>, <span class="number">0x45</span>, <span class="number">0x4A</span>, <span class="number">0x9A</span>, <span class="number">0xC3</span>, <span class="number">0x8A</span>, <span class="number">0xE5</span>, <span class="number">0x50</span>, <span class="number">0x46</span>, <span class="number">0xCC</span>, <span class="number">0x68</span>, <span class="number">0x76</span>, <span class="number">0x67</span>, <span class="number">0xC9</span>, <span class="number">0x0E</span>, <span class="number">0x3C</span>, <span class="number">0x57</span>, <span class="number">0xF0</span>, <span class="number">0x22</span>, <span class="number">0xBF</span>, <span class="number">0x26</span>, <span class="number">0x84</span>, <span class="number">0x0D</span>, <span class="number">0x90</span>, <span class="number">0xA3</span>, <span class="number">0xAE</span>, <span class="number">0x3D</span>, <span class="number">0x1D</span>, <span class="number">0xC8</span>, <span class="number">0x91</span>, <span class="number">0x05</span>, <span class="number">0x87</span>, <span class="number">0x70</span>, <span class="number">0x08</span>, <span class="number">0x73</span>, <span class="number">0x21</span>, <span class="number">0x49</span>, <span class="number">0x55</span>, <span class="number">0x3E</span>, <span class="number">0x37</span>, <span class="number">0x23</span>, <span class="number">0x18</span>, <span class="number">0x56</span>, <span class="number">0xCE</span>, <span class="number">0x82</span>, <span class="number">0x38</span>, <span class="number">0x95</span>, <span class="number">0x78</span>, <span class="number">0xF8</span>]</span><br><span class="line"></span><br><span class="line">crypto_table = <span class="built_in">dict</span>(<span class="built_in">zip</span>(s0_255,<span class="built_in">range</span>(<span class="number">0x100</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#get order table</span></span><br><span class="line">source = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;&#125;&#x27;</span></span><br><span class="line">replaced = <span class="string">&#x27;HfVl&#123;qPcCYNMoRi6D7Jr&#125;espOL3FhwdWAtTGZba4Ugjvnx1QkKE2IS9yuz5BX08m&#x27;</span></span><br><span class="line">revsere_table = [] <span class="comment">#indexæ˜¯sourceåœ¨replaceä¸­çš„ä¸‹æ ‡</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> source:</span><br><span class="line">    revsere_table.append(replaced.find(i))</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(crypto_table)</span></span><br><span class="line"><span class="comment">#print(revsere_table)</span></span><br><span class="line"></span><br><span class="line">cmp_data = [<span class="number">0x526851A7</span>, <span class="number">0x31FF2785</span>, <span class="number">0xC7D28788</span>, <span class="number">0x523F23D3</span>, <span class="number">0xAF1F1055</span>, <span class="number">0x5C94F027</span>, <span class="number">0x797A3FCD</span>, <span class="number">0xE7F02F9F</span>, <span class="number">0x3C86F045</span>, <span class="number">0x6DEAB0F9</span>, <span class="number">0x91F74290</span>, <span class="number">0x7C9A3AED</span>, <span class="number">0xDC846B01</span>, <span class="number">0x0743C86C</span>, <span class="number">0xDFF7085C</span>, <span class="number">0xA4AEE3EB</span>]</span><br><span class="line"></span><br><span class="line">tmp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cmp_data:</span><br><span class="line">    tmp+=de_cmp(i)</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    tmp = decrypt(tmp, crypto_table)</span><br><span class="line">    tmp = reverse_order(tmp, revsere_table)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> tmp))</span><br></pre></td></tr></table></figure>

<p>cmp_dataç›´æ¥æå–destæ•°æ®å°±å¯ä»¥äº†ï¼Œå› ä¸ºæ¯”è¾ƒæ•°æ®æ˜¯å›ºå®šçš„</p>
<p>æ€»ç»“ï¼šè¿™é“é¢˜å­¦åˆ°äº†ä¸å°‘ï¼Œå­¦åˆ°äº†flagæ¢ä½åŠ å¯†ç”¨å›ºå®šè¡¨ç´§è·Ÿç€ç¬¬äºŒæ¬¡åŠ å¯†ï¼ˆ64ï¼‰ï¼Œåœ¨ç¬¬äºŒæ¬¡åŠ å¯†çš„æ—¶å€™è¾“å…¥çš„å­—ç¬¦å’Œä»£ç è¡Œä¸ºæ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œæ‰€ä»¥é‡‡ç”¨äº†æ˜ å°„å­—æ¯è¡¨æŸ¥è¯¢ï¼ˆç¬¬ä¸€æ¬¡ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼‰</p>

                </div>

                
                        
<div class="article-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="post-title border-box text-ellipsis">
                2023 Hitcon CTF The Blade Reverse
            </div>

            <div class="post-link border-box text-ellipsis">
                2023/10/14/2023 Hitcon CTF The Blade Reverse/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="post-author bottom-item">
                <div class="type">
                    Author
                </div>
                <div class="content">Jsjsj</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    Published
                </div>
                <div class="content">2023-10-14 21:55</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    License
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed">
                        <i class="fa-brands fa-creative-commons"></i>
                        <i class="fa-brands fa-creative-commons-by"></i>
                        <i class="fa-brands fa-creative-commons-nc"></i>
                        <i class="fa-brands fa-creative-commons-sa"></i>
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="Copy copyright info" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Reverse/">Reverse</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                            <div class="post-share-container border-box">
    <ul class="share-list-wrap border-box">
        <li class="qq share-item border-box flex-center tooltip"
            data-tooltip-content="Share to QQ"
        >
            <i class="fa-brands fa-qq"></i>
        </li>
        <li class="wechat share-item border-box flex-center tooltip tooltip-img"
            data-tooltip-content="Share to WeChat"
            data-tooltip-img-tip="Scan by WeChat"
            data-tooltip-img-style="background-color: #fff; top: -10px; padding: 0.6rem 0.6rem 0.1rem 0.6rem;"
        >
            <i class="fa-brands fa-weixin"></i>
        </li>
        <li class="weibo share-item border-box flex-center tooltip"
            data-tooltip-content="Share to WeiBo"
        >
            <i class="fa-brands fa-weibo"></i>
        </li>
    </ul>
</div>

                        
                    </div>
                </div>

                

                
                    <div class="article-nav">
                        
                            <div class="article-prev">
                                <a class="prev"
                                   rel="prev"
                                   href="/2023/10/17/tea&amp;xtea&amp;xxtea%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC%E6%80%BB%E7%BB%93/"
                                   title="Tea&amp;XTea&amp;XXTeaè§£å¯†è„šæœ¬æ€»ç»“"
                                >
                                    <span class="left arrow-icon flex-center">
                                      <i class="fas fa-chevron-left"></i>
                                    </span>
                                            <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Tea&amp;XTea&amp;XXTeaè§£å¯†è„šæœ¬æ€»ç»“</span>
                                        <span class="post-nav-item">Prev posts</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="article-next">
                                <a class="next"
                                   rel="next"
                                   href="/2023/10/05/V8escape%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                                   title="V8 escapeç¯å¢ƒæ­å»º(ä¸€)"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">V8 escapeç¯å¢ƒæ­å»º(ä¸€)</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                            <span class="right arrow-icon flex-center">
                                      <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;Comments
        </div>
        
            

    <div class="valine-container">
        <script  src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script >
          function loadValine() {

            const config = {
              el: '#vcomments',
              appId: 'aIJeYmBe1sYhsmeD0Wx4ImDN-MdYXbMMI',
              appKey: 'Gk8i3b8sccXvUCUCkuapvLap',
              meta: ['nick', 'mail', 'link'],
              avatar: 'wavatar',
              enableQQ: true,
              placeholder: '',
              lang: 'en'.toLowerCase()
            }

            if ('https://aijeymbe.api.lncldglobal.com') {
              config.serverURLs = 'https://aijeymbe.api.lncldglobal.com'
            }

            new Valine(config)

            function getAuthor(language) {
              switch (language) {
                case 'en':
                  return 'Author'
                case 'zh-CN':
                  return 'åšä¸»'
                case 'zh-TW':
                  return 'ç«™é•·'
                default:
                  return 'Master'
              }
            }

            // Add "Author" identify
            const getValineDomTimer = setInterval(() => {
              const vcards = document.querySelectorAll('#vcomments .vcards .vcard')
              if (vcards.length > 0) {
                let author = 'Jsjsj'

                if (author) {
                  for (let vcard of vcards) {
                    const vnick_dom = vcard.querySelector('.vhead .vnick')
                    const vnick = vnick_dom.innerHTML
                    if (vnick === author) {
                      vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                    }
                  }
                }
                clearInterval(getValineDomTimer)
              } else {
                clearInterval(getValineDomTimer)
              }
            }, 2000)
          }

          if ('false' === 'true') {
            const loadValineTimeout = setTimeout(() => {
              loadValine()
              clearTimeout(loadValineTimeout)
            }, 1000)
          } else {
            window.addEventListener('DOMContentLoaded', loadValine)
          }
        </script>
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="border-box website-info-box default">
        
            <div class="copyright-info info-item default">
                &copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2023
                
                    &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">Jsjsj</a>
                
            </div>

            <div class="theme-info info-item default">
                Powered by&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;&&nbsp;Theme&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
            </div>

            

            
        

        <div class="count-item info-item default">
            

            

            
        </div>
    </div>
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="tools-list border-box">
        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        
    </div>
</div>

            </div>
        </div>
    
</main>



<!-- common -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local-search -->

    
<script src="/js/local-search.js"></script>



<!-- code-block -->

    
<script src="/js/code-block.js"></script>



<!-- lazyload -->

    
<script src="/js/lazyload.js"></script>



<div class="">
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        
            
<script src="/js/post/copyright-info.js"></script>

        

        <!-- share -->
        
            
<script src="/js/post/share.js"></script>

        
    

    <!-- category-page -->
    

    <!-- links-page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
